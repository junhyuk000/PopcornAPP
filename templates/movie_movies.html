{% extends "movie_base.html" %}
{% block css %}
<style>
    .carousel-item h5 {
        font-size: 1.5rem;
        color: #cababa;
    }
    
    .carousel-item p {
        font-size: 1rem;
        color: #a79696;
    }

    /* 캐러셀 좌우 버튼 색 변경 */
    .carousel-control-prev-icon,
    .carousel-control-next-icon {
        filter: invert(1);
    }

    /* Carousel Indicators 아래로 이동 및 색상 변경 */
    .carousel-indicators {
        position: absolute;
        bottom: -50px;
    }

    .carousel-indicators button {
        background-color: #bfa187 !important;
        border: 1px solid #fff;
        width: 12px;
        height: 12px;
        border-radius: 50%;
    }

    .carousel-indicators .active {
        background-color: #8a6f55 !important;
    }

    /* Swiper 스타일 */
    .swiper {
        width: 90%;
        height: 650px;
        padding: 40px 0;
        display: flex;
        justify-content: center;
    }
    .swiper-slide {
        display: flex;
        align-items: center;
        justify-content: center;
        transition: transform 0.3s ease-in-out;
    }
    .swiper-slide img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 15px;
        transition: transform 0.3s ease-in-out;
    }
    .swiper-slide-active {
        transform: scale(1.2);
        box-shadow: none;
    }

    /* 영화 정보 상단으로 이동 */
    .movie-info {
        text-align: center;
        margin-bottom: 20px;
    }

    /* 네비게이션 버튼 위치 및 색상 조정 */
    .swiper-button-next,
    .swiper-button-prev {
        color: #ad7b67 !important;
        width: 50px;
        height: 50px;
    }
    .swiper-button-next {
        right: -80px;
    }
    .swiper-button-prev {
        left: -80px;
    }
</style>
{% endblock %}
{% block title %}Movie Rankings{% endblock %}

{% block content %}
<div class="container">
    <div class="movie-info">
        <h2 style="color: #ad7b67;" id="movie-title"></h2>
        <p id="movie-rating"></p>
        <p id="movie-rank"></p>
        <p id="movie-reviews"></p>
        <a id="movie-trailer" class="btn btn-outline-light mx-2" style="color: #ad7b67;">예고편</a>
        <a id="movie-review" class="btn btn-outline-light mx-2" style="color: #ad7b67;">Review</a>
    </div>

    <!-- Swiper 슬라이더 -->
    <div class="swiper mySwiper">
        <div class="swiper-wrapper">
            {% for movie in movies_info %}
            <div class="swiper-slide" data-index="{{ loop.index0 }}">
                <img src="/static/images/{{ movie.filename }}" alt="{{ movie.title }}">
            </div>
            {% endfor %}
        </div>
        <!-- 네비게이션 버튼 -->
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>
</div>
<script>
    var moviesData = JSON.parse('{{ movies_info | tojson | safe }}');
</script>
{% endblock %}

{% block js %}
<script src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script>
<script>
    var swiper = new Swiper(".mySwiper", {
        slidesPerView: 3,
        spaceBetween: 20,
        centeredSlides: true,
        loop: true,
        autoplay: {
            delay: 2000,
            disableOnInteraction: false,
        },
        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
        },
        effect: "coverflow",
        coverflowEffect: {
            rotate: 0,
            stretch: 100,
            depth: 200,
            modifier: 1,
            slideShadows: false,
        },
        on: {
            slideChange: function () {
                var activeIndex = swiper.realIndex;
                document.getElementById("movie-title").textContent = moviesData[activeIndex].title;
                document.getElementById("movie-rating").textContent = "Rating: " + moviesData[activeIndex].rating;
                document.getElementById("movie-rank").textContent = "Rank: " + moviesData[activeIndex].rank;
                document.getElementById("movie-reviews").textContent = "Reviews: " + moviesData[activeIndex].reviews;
                document.getElementById("movie-trailer").href = "/movie_youtube/" + moviesData[activeIndex].title;
                document.getElementById("movie-review").href = "/reviews/" + moviesData[activeIndex].title + "/" + moviesData[activeIndex].id;
            }
        }
    });

    // 초기 정보 설정
    document.getElementById("movie-title").textContent = moviesData[0].title;
    document.getElementById("movie-rating").textContent = "Rating: " + moviesData[0].rating;
    document.getElementById("movie-rank").textContent = "Rank: " + moviesData[0].rank;
    document.getElementById("movie-reviews").textContent = "Reviews: " + moviesData[0].reviews;
    document.getElementById("movie-trailer").href = "/movie_youtube/" + moviesData[0].title;
    document.getElementById("movie-review").href = "/reviews/" + moviesData[0].title + "/" + moviesData[0].id;
</script>
{% endblock %}
